@model IEnumerable<Menu>
<section class="page_breadcrumb" style="background: url(/kullanici/images/counter_bg.jpg);">
    <div class="breadcrumb_overlay">
        <div class="container">
            <div class="breadcrumb_text">
                <h1>cart view</h1>
                <ul>
                    <li><a href="index-2.html">home</a></li>
                    <li><a href="#">cart view</a></li>
                </ul>
            </div>
        </div>
    </div>
</section>
<!--=============================
    BREADCRUMB END
==============================-->
<!--============================
    CART VIEW START
==============================-->
<section class="cart_view mt_100 xs_mt_70 mb_100 xs_mb_70">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 wow fadeInUp" data-wow-duration="1s">
                <div class="cart_list">
                    <div class="table-responsive">
                        <table id="sepetTablosu">
                            <tbody id="sepetListesi">
                                <tr>
                                    <th class="pro_img">
                                        Resim
                                    </th>
                                    <th class="pro_name">
                                        Detaylar
                                    </th>
                                    <th class="pro_status">
                                        Fiyat
                                    </th>
                                    <th class="pro_select">
                                        Miktar
                                    </th>
                                    <th class="pro_tk">
                                        Toplam
                                    </th>
                                    <th class="pro_icon">
                                        <a class="clear_all" href="#">Tümünü Temizle</a>
                                    </th>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-lg-12 wow fadeInUp" data-wow-duration="1s">
                <div class="cart_list_footer_button mt_50">
                    <div class="row">
                        <div class="col-xl-7 col-md-6">
                            <div class="cart_list_footer_button_img">
                                <img src="/kullanici/images/cart_offer_img.jpg" alt="cart offer" class="img-fluid w-100">
                            </div>
                        </div>
                        <div class="col-xl-5 col-md-6">
                            <div class="cart_list_footer_button_text">
                                <h6>Toplam Sepet</h6>
                                <p>Ara Toplam: <span>$124.00</span></p>
                                <p>Teslimat: <span>$00.00</span></p>
                                <p>İndirim: <span>$10.00</span></p>
                                <p class="total"><span>Toplam:</span> <span>$134.00</span></p>
                                <form>
                                    <input type="text" placeholder="Kupon Uygula">
                                    <button type="submit">Uygula</button>
                                </form>
                                <a class="common_btn" href="check_out.html">checkout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
    var sepetVerisi = localStorage.getItem('Sepet');
    var sepetArray = JSON.parse(sepetVerisi);
    var sepetTablosu = document.getElementById('sepetTablosu');
    var sepetListesi = document.getElementById('sepetListesi');

    if (sepetArray && sepetArray.length > 0) {
        sepetArray.forEach(function (menu) {
            if (menu.indirimliFiyat) {
                var toplamFiyat = menu.indirimliFiyat * menu.adet;
            } else {
                var toplamFiyat = menu.fiyat * menu.adet;
            } var fiyatHtml = menu.indirimliFiyat ? `<del>${menu.fiyat}₺</del> <span class="text-danger">${menu.indirimliFiyat}₺</span>` : `<span>${menu.fiyat}₺</span>`;

            var html = `
                        <tr>
                            <td class="pro_img">
                                    <img src="${'/img/' + menu.fotograf}" alt="Ürün resmi" class="img-fluid w-100">
                            </td>
                            <td class="pro_name">
                                <a href="#">${menu.ad}</a>
                                <span>${menu.aciklama}</span>
                                <span>Boyutu: ${menu.boyut}</span>
                            </td>
                            <td class="pro_status">
                                <h6>${fiyatHtml}</h6>
                            </td>
                            <td class="pro_select">
                                <div class="quentity_btn">
                                    <button class="btn btn-danger"><i class="fal fa-minus"></i></button>
                                    <input type="text" id="sepetadet" placeholder="1" value="${menu.adet}">
                                    <button class="btn btn-success"><i class="fal fa-plus"></i></button>
                                </div>
                            </td>
                               <td class="pro_tk">
                                    <h6><span id="toplamFiyat">${toplamFiyat}₺</span></h6> <!-- Toplam fiyatı burada göster -->
                                </td>
                            <td class="pro_icon">
                                <a href="#" class="delete-row"><i class="far fa-times"></i></a>
                            </td>
                        </tr>
                    `;

            // HTML içeriğini tabloya ekle
            sepetListesi.insertAdjacentHTML('beforeend', html);
        });
    } else {
        // Eğer sepette hiç öğe yoksa
        sepetTablosu.innerHTML = "<p>Sepetinizde henüz ürün bulunmamaktadır.</p>";
    }
</script>

<script>


    // var sepetVerisi = localStorage.getItem('Sepet');
    // var sepetArray = JSON.parse(sepetVerisi);
    // var sepetListesi = document.getElementById('sepetListesi');





    // if (!sepetArray || sepetArray.length === 0) {
    //     sepetListesi.innerHTML = '<tr><td colspan="6">Sepetinizde ürün bulunmamaktadır.</td></tr>';
    // } else {
    //     sepetArray.forEach(function (menu) {
    //         var row = document.createElement('tr');

    //         var imgCell = document.createElement('td');
    //         imgCell.style.width = '191px'; // Sütun genişliği
    //         var img = document.createElement('img');
    //         img.src = '/img/' + menu.fotograf;
    //         img.alt = menu.ad;
    //         img.style.maxWidth = '100px';
    //         img.style.height = 'auto';
    //         imgCell.appendChild(img);
    //         row.appendChild(imgCell);


    //         var detailsCell = document.createElement('td');
    //         detailsCell.style.width = '368px'; // Sütun genişliği
    //         var nameLink = document.createElement('a');
    //         nameLink.href = '#';
    //         nameLink.textContent = menu.ad; // Doğru ürün adını kullanın
    //         var description = document.createElement('p');
    //         description.textContent = menu.aciklama; // Ürün açıklamasını kullanın
    //         detailsCell.appendChild(nameLink);
    //         detailsCell.appendChild(description); // Açıklamayı detay hücresine ekleyin
    //         row.appendChild(detailsCell);

    //         var priceCell = document.createElement('td');
    //         priceCell.style.textAlign = 'center'; // Metni ortala
    //         var price = document.createElement('h6');
    //         price.textContent = menu.fiyat; // Doğru fiyatı kullanın
    //         priceCell.appendChild(price);
    //         row.appendChild(priceCell);


    //         var quantityCell = document.createElement('td');
    //         quantityCell.style.width = '160px'; // Sütun genişliği
    //         var quantityInput = document.createElement('input');
    //         quantityInput.type = 'text';
    //         quantityInput.value = '1';
    //         quantityCell.appendChild(quantityInput);
    //         row.appendChild(quantityCell);

    //         var totalCell = document.createElement('td');
    //         totalCell.style.width = '60px'; // Sütun genişliği

    //         var total = document.createElement('h6');
    //         total.textContent = menu.Price;
    //         totalCell.appendChild(total);
    //         row.appendChild(totalCell);

    //         var deleteCell = document.createElement('td');
    //         deleteCell.style.width = '60px'; // Sütun genişliği

    //         var deleteLink = document.createElement('a');
    //         deleteLink.href = '#';
    //         deleteLink.innerHTML = '<i class="far fa-times"></i>';
    //         deleteCell.appendChild(deleteLink);
    //         row.appendChild(deleteCell);

    //         sepetListesi.appendChild(row);
    //     });
    // }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    function deleteItem(event) {
        var row = event.target.closest('tr');

        if (row) {
            var rowIndex = row.rowIndex - 1;

            var sepetVerisi = localStorage.getItem('Sepet');

            if (sepetVerisi) {
                var sepetArray = JSON.parse(sepetVerisi);
                if (rowIndex >= 0 && rowIndex < sepetArray.length) {
                    Swal.fire({
                        title: 'Emin misiniz?',
                        text: "Bu öğeyi silmek istediğinizden emin misiniz?",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Evet, sil!',
                        cancelButtonText: 'İptal'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            sepetArray.splice(rowIndex, 1);

                            localStorage.setItem('Sepet', JSON.stringify(sepetArray));

                            row.remove();

                            Swal.fire(
                                'Silindi!',
                                'Seçilen öğe başarıyla silindi.',
                                'success'
                            );
                        }
                    });
                }
            }
        }
    }
    var deleteButtons = document.querySelectorAll('.delete-row');
    deleteButtons.forEach(function (button) {
        button.addEventListener('click', deleteItem);
    });


</script>


<script>
    // Tümünü temizleme işlevi
    function clearAllItems(event) {
        event.preventDefault(); // Bağlantıya varsayılan işlevi durdur
        Swal.fire({
            title: 'Emin misiniz?',
            text: "Tüm öğeleri temizlemek istediğinizden emin misiniz?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Evet, temizle!',
            cancelButtonText: 'İptal'
        }).then((result) => {
            if (result.isConfirmed) {
                localStorage.removeItem('Sepet'); // Sepet verilerini temizle
                document.getElementById('sepetListesi').innerHTML = ''; // Tabloyu temizle
                Swal.fire(
                    'Temizlendi!',
                    'Sepetiniz başarıyla temizlendi.',
                    'success'
                );
            }
        });
    }

    // Tümünü temizle bağlantısına olay dinleyici ekleyin
    var clearAllLink = document.querySelector('.clear_all');
    clearAllLink.addEventListener('click', clearAllItems);
</script>



